!function(){"use strict";angular.module("angular",["ngAnimate","ngCookies","ngStorage","ngTouch","ngSanitize","ngMessages","ngAria","restangular","ui.router","ui.bootstrap","toastr","angularMoment","angular.filter"])}(),function(){"use strict";function e(){function e(){var e=this;e.profile=e.owner}var o={restrict:"E",templateUrl:"app/components/noosfero-blocks/profile-image/profile-image.html",scope:{block:"=",owner:"="},controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoProfileImageBlock",e)}(),function(){"use strict";function e(){function e(e){var o=this;o.members=[],e.members(e.profiles.one(o.owner.id)).one().get({per_page:6}).then(function(e){o.members=e.people})}e.$inject=["noosfero"];var o={restrict:"E",templateUrl:"app/components/noosfero-blocks/members-block/members-block.html",scope:{block:"=",owner:"="},controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoMembersBlock",e)}(),function(){"use strict";function e(){function e(){}var o={restrict:"E",templateUrl:"app/components/noosfero-blocks/main-block/main-block.html",scope:{block:"=",owner:"="},controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoMainBlock",e)}(),function(){"use strict";function e(){function e(){var e=this;e.links=e.block.settings.links}var o={restrict:"E",templateUrl:"app/components/noosfero-blocks/link-list/link-list.html",scope:{block:"=",owner:"="},controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoLinkListBlock",e)}(),function(){"use strict";function e(){function e(){}var o={restrict:"E",templateUrl:"app/components/noosfero-articles/blog/blog.html",scope:{article:"=",profile:"="},controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoBlog",e)}(),function(){"use strict";function e(e,o){function i(){}var n={restrict:"E",templateUrl:"app/components/noosfero-articles/article/article.html",scope:{article:"=",profile:"="},controller:i,controllerAs:"vm",bindToController:!0,link:function(i,n){var r="noosfero"+i.vm.article.type;if(e.has(r+"Directive")){var t=r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();n.replaceWith(o("<"+t+' article="vm.article" profile="vm.profile"></'+t+">")(i))}}};return n}e.$inject=["$injector","$compile"],angular.module("angular").directive("noosferoArticle",e)}(),function(){"use strict";function e(){function e(){var e=this;e.getActivityTemplate=function(e){return"app/components/noosfero-activities/activity/"+e.verb+".html"}}var o={restrict:"E",scope:{activity:"="},templateUrl:"app/components/noosfero-activities/activity/activity.html",replace:!0,controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoActivity",e)}(),function(){"use strict";function e(){function e(){var e=this;e.defaultIcon="fa-users","Person"===e.profile.type&&(e.defaultIcon="fa-user")}var o={restrict:"E",templateUrl:"app/components/noosfero/profile-image/profile-image.html",scope:{profile:"="},controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoProfileImage",e)}(),function(){"use strict";function e(){function e(){var e=this;e.boxesOrder=function(e){return 2==e.position?0:e.position}}var o={restrict:"E",scope:{boxes:"=",owner:"="},templateUrl:"app/components/noosfero-boxes/boxes.html",controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoBoxes",e)}(),function(){"use strict";function e(e){var o={restrict:"E",scope:{block:"=",owner:"="},link:function(o,i){var n=o.block.type.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();i.replaceWith(e("<noosfero-"+n+' block="block" owner="owner"></noosfero-'+n+">")(o))}};return o}e.$inject=["$compile"],angular.module("angular").directive("noosferoBlock",e)}(),function(){"use strict";function e(){var e={restrict:"E",scope:{activities:"="},templateUrl:"app/components/noosfero-activities/activities.html"};return e}angular.module("angular").directive("noosferoActivities",e)}(),function(){"use strict";angular.module("angular").factory("noosfero",["Restangular",function(e){return{profiles:e.service("profiles"),members:function(o){return e.service("members",o)},boxes:function(o){return e.service("boxes",e.one("profiles",o))}}}])}(),function(){"use strict";angular.module("angular").filter("noosferoTemplateFilter",function(){return function(e,o){for(var i in o)e=e.replace("{"+i+"}",o[i]);return e}})}(),function(){"use strict";function e(){function e(e,o,i,n,r,t,a){var l=this;l.relativeDate=e(l.creationDate).fromNow(),l.currentUser=n.getCurrentUser(),l.modalInstance=null,l.openLogin=function(){l.modalInstance=o.open({templateUrl:"app/components/auth/login.html",controller:"AuthController",controllerAs:"vm",bindToController:!0})},l.logout=function(){i.logout(),t.go(t.current,{},{reload:!0})},r.$on(a.loginSuccess,function(){l.modalInstance&&(l.modalInstance.close(),l.modalInstance=null),t.go(t.current,{},{reload:!0})}),r.$on(a.logoutSuccess,function(){l.currentUser=n.getCurrentUser()}),l.currentUser||l.openLogin()}e.$inject=["moment","$modal","AuthService","Session","$scope","$state","AUTH_EVENTS"];var o={restrict:"E",templateUrl:"app/components/navbar/navbar.html",scope:{creationDate:"="},controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("acmeNavbar",e)}(),function(){"use strict";function e(e,o,i,n,r,t){function a(e){var i="/api/v1/login",n="login="+e.username+"&password="+e.password;return o.post(i,n).then(s,c)}function l(){var e="/api/v1/login_from_cookie";return o.post(e).then(s,c)}function s(e){r.debug("AuthService.login [SUCCESS] response",e);var o=n.create(e.data);return i.currentUser=o,i.$broadcast(t.loginSuccess,o),o}function c(e){return r.debug("AuthService.login [FAIL] response",e),i.$broadcast(t.loginFailed),null}function p(){n.destroy(),i.currentUser=void 0,i.$broadcast(t.logoutSuccess),o.jsonp("/account/logout")}function u(){return!!n.userId}function m(e){return angular.isArray(e)||(e=[e]),f.isAuthenticated()&&-1!==e.indexOf(n.userRole)}var f={login:a,loginFromCookie:l,logout:p,isAuthenticated:u,isAuthorized:m};return f}function o(e,o){var i={};return i.create=function(i){return e.currentUser=i.user,o.debug("User session created.",e.currentUser),e.currentUser},i.destroy=function(){delete e.currentUser,o.debug("User session destroyed.")},i.getCurrentUser=function(){return e.currentUser},i}e.$inject=["$q","$http","$rootScope","Session","$log","AUTH_EVENTS"],o.$inject=["$localStorage","$log"],angular.module("angular").factory("Session",o).factory("AuthService",e)}(),function(){"use strict";function e(e,o,i,n){var r=this;r.credentials={},r.login=function(){n.login(r.credentials)}}e.$inject=["noosfero","$log","$stateParams","AuthService"],angular.module("angular").controller("AuthController",e)}(),function(){"use strict";function e(e,o,i,n){function r(){t.profile=n.vm.owner,e.profiles.one(t.profile.id).one("activities").get().then(function(e){t.activities=e.activities})}var t=this;t.profile=null,t.activities=[],r()}e.$inject=["noosfero","$log","$stateParams","$scope"],angular.module("angular").controller("ProfileInfoController",e)}(),function(){"use strict";function e(e,o,i){function n(){e.profiles.one().get({identifier:i.profile}).then(function(o){return r.profile=o[0],e.boxes(r.profile.id).one().get()}).then(function(e){r.boxes=e.boxes})}var r=this;r.boxes=[],n()}e.$inject=["noosfero","$log","$stateParams"],angular.module("angular").controller("ProfileController",e)}(),function(){"use strict";function e(){}angular.module("angular").controller("MainController",e)}(),function(){"use strict";function e(e,o,i,n){function r(){t.profile=n.vm.owner,e.profiles.one(t.profile.id).one("articles").get({path:i.page}).then(function(e){t.article=e.article})}var t=this;t.article=null,t.profile=null,r()}e.$inject=["noosfero","$log","$stateParams","$scope"],angular.module("angular").controller("ContentViewerController",e)}(),function(){"use strict";function e(e,o,i){o.addFullRequestInterceptor(function(e,o,n,r,t){return i.getCurrentUser()&&(t["Private-Token"]=i.getCurrentUser().private_token),{headers:t}})}e.$inject=["$log","Restangular","Session"],angular.module("angular").run(e)}(),function(){"use strict";function e(e,o){o.when("/:profile","/profile/:profile"),e.state("main",{url:"/",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"vm",resolve:{currentUser:["AuthService",function(e){return e.loginFromCookie()}]}}).state("main.profile",{url:":profile",templateUrl:"app/profile/profile.html",controller:"ProfileController",controllerAs:"vm"}).state("main.profile.info",{url:"^/profile/:profile",templateUrl:"app/profile-info/profile-info.html",controller:"ProfileInfoController",controllerAs:"vm"}).state("main.profile.page",{url:"/{page:any}",templateUrl:"app/content-viewer/page.html",controller:"ContentViewerController",controllerAs:"vm"}).state("main.profile.settings",{url:"^/myprofile/:profile"}),o.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("angular").config(e)}(),function(){"use strict";angular.module("angular").constant("moment",moment).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success"})}(),function(){"use strict";function e(e,o,i,n){e.debugEnabled(!0),o.html5Mode({enabled:!0}),i.setBaseUrl("/api/v1"),n.defaults.headers.post={"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"}}e.$inject=["$logProvider","$locationProvider","RestangularProvider","$httpProvider"],angular.module("angular").config(e)}(),angular.module("angular").run(["$templateCache",function(e){e.put("app/content-viewer/page.html",'<noosfero-article ng-if="vm.article" article="vm.article" profile="vm.profile"></noosfero-article>'),e.put("app/main/main.html",'<acme-navbar></acme-navbar><div ui-view=""></div>'),e.put("app/profile-info/profile-info.html",'<h3>{{vm.profile.name}}</h3><div class="profile-wall"><h4>Profile Wall</h4><noosfero-activities activities="vm.activities"></noosfero-activities></div>'),e.put("app/profile/profile.html",'<div class="profile-container"><div class="row"><noosfero-boxes boxes="vm.boxes" owner="vm.profile"></noosfero-boxes></div></div>'),e.put("app/components/auth/login.html",'<div class="modal-header"><h3 class="modal-title">Login</h3></div><div class="modal-body"><form><div class="form-group"><label for="exampleInputEmail1">Login / Email address</label> <input type="text" class="form-control" id="exampleInputEmail1" placeholder="Login / Email" ng-model="vm.credentials.username"></div><div class="form-group"><label for="exampleInputPassword1">Password</label> <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password" ng-model="vm.credentials.password"></div><button type="submit" class="btn btn-default" ng-click="vm.login()">Login</button></form></div>'),e.put("app/components/boxes/boxes.html",'{{vm.boxesOrder}} {{boxesOrder}}<ng-include ng-repeat="box in vm.boxes | orderBy: vm.boxesOrder" src="\'app/components/noosfero-boxes/box.html\'"></ng-include>'),e.put("app/components/navbar/navbar.html",'<nav class="navbar navbar-static-top navbar-inverse"><div class="container-fluid"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" ng-click="isCollapsed = !isCollapsed"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" ui-sref="main"><span class="noosfero-logo"><img src="/designs/themes/angular-theme/dist/assets/images/logo-noosfero.png"></span> Noosfero</a></div><div class="collapse navbar-collapse" id="navbar-collapse" collapse="isCollapsed"><ul class="nav navbar-nav"></ul><ul class="nav navbar-nav navbar-right"><li ng-show="!vm.currentUser"><a ng-href="#" ng-click="vm.openLogin()">Login</a></li><li class="dropdown profile-menu" ng-show="vm.currentUser" dropdown=""><a href="#" class="dropdown-toggle" aria-expanded="false" dropdown-toggle=""><noosfero-profile-image profile="vm.currentUser.person" class="profile-image"></noosfero-profile-image><span ng-bind="vm.currentUser.person.name"></span> <b class="caret"></b></a><ul class="dropdown-menu" dropdown-menu=""><li><a ui-sref="main.profile.info({profile: vm.currentUser.person.identifier})"><i class="fa fa-fw fa-user"></i> Profile</a></li><li><a target="_self" ui-sref="main.profile.settings({profile: vm.currentUser.person.identifier})"><i class="fa fa-fw fa-gear"></i> Settings</a></li><li class="divider"></li><li><a href="#" ng-click="vm.logout()"><i class="fa fa-fw fa-power-off"></i> Log Out</a></li></ul></li></ul></div></div></nav>'),e.put("app/components/noosfero-activities/activities.html",'<ul class="timeline"><li ng-class-even="\'timeline-inverted\'" ng-repeat="activity in activities | orderBy: \'created_at\':true"><noosfero-activity activity="activity"></noosfero-activity></li></ul>'),e.put("app/components/noosfero-boxes/box.html",'<div ng-class="{\'col-md-2-5\': box.position!=1, \'col-md-7\': box.position==1}"><div ng-repeat="block in box.blocks | orderBy: \'position\'" class="panel panel-default block"><div class="panel-heading" ng-show="block.title"><h3 class="panel-title">{{block.title}}</h3></div><div class="panel-body"><noosfero-block block="block" owner="vm.owner"></noosfero-block></div></div></div>'),e.put("app/components/noosfero-boxes/boxes.html",'<ng-include ng-repeat="box in vm.boxes | orderBy: vm.boxesOrder" src="\'app/components/noosfero-boxes/box.html\'"></ng-include>'),e.put("app/components/noosfero/profile-image/profile-image.html",'<span title="{{vm.profile.name}}"><img ng-if="vm.profile.image" ng-src="{{vm.profile.image.url}}" class="img-responsive profile-image"> <i ng-if="!vm.profile.image" class="fa {{vm.defaultIcon}} fa-5x profile-image"></i></span>'),e.put("app/components/noosfero-activities/activity/activity.html",'<div class="activity"><ng-include src="vm.getActivityTemplate(vm.activity)"></ng-include></div>'),e.put("app/components/noosfero-activities/activity/add_member_in_community.html",'<div class="timeline-badge info"><i class="fa fa-user-plus"></i></div><div class="timeline-panel"><div class="timeline-heading"><h4 class="timeline-title"><a ui-sref="main.profile.info({profile: vm.activity.user.identifier})"><strong ng-bind="vm.activity.user.name"></strong></a> <span>has joined the community</span></h4><p><small class="text-muted"><i class="fa fa-clock-o"></i> <span am-time-ago="vm.activity.created_at"></span></small></p></div><div class="timeline-body"></div></div>'),e.put("app/components/noosfero-activities/activity/create_article.html",'<div class="timeline-badge success"><i class="fa fa-file-text"></i></div><div class="timeline-panel"><div class="timeline-heading"><h4 class="timeline-title"><a ui-sref="main.profile({profile: vm.activity.user.identifier})"><strong ng-bind="vm.activity.user.name"></strong></a> <span>has published on</span> <a ui-sref="main.profile({profile: vm.activity.target.article.profile.identifier})"><strong ng-bind="vm.activity.target.article.profile.name"></strong></a></h4><p><small class="text-muted"><i class="fa fa-clock-o"></i> <span am-time-ago="vm.activity.created_at"></span></small></p></div><div class="timeline-body"><div class="article"><div class="title"><a ui-sref="main.profile.page({profile: vm.activity.target.article.profile.identifier, page: vm.activity.target.article.path})" ng-bind="vm.activity.target.article.title"></a></div><div class="lead small"><div ng-bind-html="vm.activity.target.article.body | stripTags | truncate: 100 : \'...\'"></div></div></div></div></div>'),e.put("app/components/noosfero-activities/activity/new_friendship.html",'<div class="timeline-badge info"><i class="fa fa-user-plus"></i></div><div class="timeline-panel"><div class="timeline-heading"><h4 class="timeline-title"><a ui-sref="main.profile.info({profile: vm.activity.user.identifier})"><strong ng-bind="vm.activity.user.name"></strong></a> <span>has made <span ng-bind="vm.activity.params.friend_name.length"></span> new friend(s):</span> <span class="comma-separated"><a class="separated-item" ui-sref="main.profile.info({profile: vm.activity.params.friend_url[$index].profile})" ng-repeat="friend in vm.activity.params.friend_name"><strong ng-bind="friend"></strong></a></span></h4><p><small class="text-muted"><i class="fa fa-clock-o"></i> <span am-time-ago="vm.activity.created_at"></span></small></p></div><div class="timeline-body"></div></div>'),e.put("app/components/noosfero-articles/article/article.html",'<div class="article"><div class="page-header"><h3 ng-bind="vm.article.title"></h3></div><div class="sub-header clearfix"><div class="page-info pull-right small text-muted"><span class="time"><i class="fa fa-clock-o"></i> <span am-time-ago="vm.article.created_at"></span></span> <span class="author" ng-if="vm.article.author"><i class="fa fa-user"></i> <a ui-sref="main.profile({profile: vm.article.author.identifier})"><span class="author-name" ng-bind="vm.article.author.name"></span></a></span></div></div><div class="page-body"><div ng-bind-html="vm.article.body"></div></div></div>'),e.put("app/components/noosfero-articles/blog/blog.html",'<div class="blog"><div class="blog-cover" ng-show="vm.article.image"><img ng-src="{{vm.article.image.url}}" class="img-responsive"><h3 ng-bind="vm.article.title"></h3></div><div class="page-header" ng-show="!vm.article.image"><h3 ng-bind="vm.article.title"></h3></div><div><div ng-repeat="child in vm.article.children | orderBy: \'created_at\':true"><div class="page-header"><a class="title" ui-sref="main.profile.page({profile: vm.profile.identifier, page: child.path})"><h4 ng-bind="child.title"></h4></a><div class="post-lead" ng-bind-html="child.body | truncate: 500: \'...\'"></div></div></div></div></div>'),e.put("app/components/noosfero-blocks/link-list/link-list.html",'<div class="link-list-block"><div ng-repeat="link in vm.links"><a ng-href="{{link.address | noosferoTemplateFilter:{profile: vm.owner.identifier} }}"><i class="fa fa-fw icon-{{link.icon}}"></i> <span>{{link.name}}</span></a></div></div>'),e.put("app/components/noosfero-blocks/main-block/main-block.html",'<div ui-view=""></div>'),e.put("app/components/noosfero-blocks/members-block/members-block.html",'<div class="members-block"><a ng-repeat="member in vm.members" ui-sref="main.profile({profile: member.identifier})" class="member"><noosfero-profile-image profile="member"></noosfero-profile-image></a></div>'),e.put("app/components/noosfero-blocks/profile-image/profile-image.html",'<div class="center-block text-center profile-image-block"><a ui-sref="main.profile.info({profile: vm.owner.identifier})"><noosfero-profile-image profile="vm.owner"></noosfero-profile-image></a> <a class="settings-link" target="_self" ui-sref="main.profile.settings({profile: vm.owner.identifier})">Control panel</a></div>')}]);
//# sourceMappingURL=../maps/scripts/app-6b2da25dcb.js.map
