!function(){"use strict";angular.module("angular",["ngAnimate","ngCookies","ngStorage","ngTouch","ngSanitize","ngMessages","ngAria","restangular","ui.router","ui.bootstrap","toastr","angularMoment","angular.filter"])}(),function(){"use strict";function e(){function e(){var e=this;e.profile=e.owner}var o={restrict:"E",templateUrl:"app/components/noosfero-blocks/profile-image/profile-image.html",scope:{block:"=",owner:"="},controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoProfileImageBlock",e)}(),function(){"use strict";function e(){function e(){}var o={restrict:"E",templateUrl:"app/components/noosfero-blocks/main-block/main-block.html",scope:{block:"=",owner:"="},controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoMainBlock",e)}(),function(){"use strict";function e(){function e(){var e=this;e.links=e.block.settings.links}var o={restrict:"E",templateUrl:"app/components/noosfero-blocks/link-list/link-list.html",scope:{block:"=",owner:"="},controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoLinkListBlock",e)}(),function(){"use strict";function e(){function e(){}var o={restrict:"E",templateUrl:"app/components/noosfero-articles/blog/blog.html",scope:{article:"=",profile:"="},controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoBlog",e)}(),function(){"use strict";function e(e,o){function n(){}var t={restrict:"E",templateUrl:"app/components/noosfero-articles/article/article.html",scope:{article:"=",profile:"="},controller:n,controllerAs:"vm",bindToController:!0,link:function(n,t){var r="noosfero"+n.vm.article.type;if(e.has(r+"Directive")){var i=r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();t.replaceWith(o("<"+i+' article="vm.article" profile="vm.profile"></'+i+">")(n))}}};return t}e.$inject=["$injector","$compile"],angular.module("angular").directive("noosferoArticle",e)}(),function(){"use strict";function e(){function e(){var e=this;e.getActivityTemplate=function(e){return"app/components/noosfero-activities/activity/"+e.verb+".html"}}var o={restrict:"E",scope:{activity:"="},templateUrl:"app/components/noosfero-activities/activity/activity.html",replace:!0,controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoActivity",e)}(),function(){"use strict";function e(){function e(){var e=this;e.boxesOrder=function(e){return 2==e.position?0:e.position}}var o={restrict:"E",scope:{boxes:"=",owner:"="},templateUrl:"app/components/noosfero-boxes/boxes.html",controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("noosferoBoxes",e)}(),function(){"use strict";function e(e){var o={restrict:"E",scope:{block:"=",owner:"="},link:function(o,n){var t=o.block.type.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();n.replaceWith(e("<noosfero-"+t+' block="block" owner="owner"></noosfero-'+t+">")(o))}};return o}e.$inject=["$compile"],angular.module("angular").directive("noosferoBlock",e)}(),function(){"use strict";function e(){var e={restrict:"E",scope:{activities:"="},templateUrl:"app/components/noosfero-activities/activities.html"};return e}angular.module("angular").directive("noosferoActivities",e)}(),function(){"use strict";angular.module("angular").factory("noosfero",["Restangular",function(e){return{profiles:e.service("profiles"),boxes:function(o){return e.service("boxes",e.one("profiles",o))}}}])}(),function(){"use strict";angular.module("angular").filter("noosferoTemplateFilter",function(){return function(e,o){for(var n in o)e=e.replace("{"+n+"}",o[n]);return e}})}(),function(){"use strict";function e(){function e(e,o,n,t,r,i,l){var a=this;a.relativeDate=e(a.creationDate).fromNow(),a.currentUser=t.getCurrentUser(),a.modalInstance=null,a.openLogin=function(){a.modalInstance=o.open({templateUrl:"app/components/auth/login.html",controller:"AuthController",controllerAs:"vm",bindToController:!0})},a.logout=function(){n.logout(),i.go(i.current,{},{reload:!0})},r.$on(l.loginSuccess,function(){a.modalInstance&&(a.modalInstance.close(),a.modalInstance=null),i.go(i.current,{},{reload:!0})}),r.$on(l.logoutSuccess,function(){a.currentUser=t.getCurrentUser()}),a.currentUser||a.openLogin()}e.$inject=["moment","$modal","AuthService","Session","$scope","$state","AUTH_EVENTS"];var o={restrict:"E",templateUrl:"app/components/navbar/navbar.html",scope:{creationDate:"="},controller:e,controllerAs:"vm",bindToController:!0};return o}angular.module("angular").directive("acmeNavbar",e)}(),function(){"use strict";function e(e,o,n,t,r,i){function l(e){var n="/api/v1/login",t="login="+e.username+"&password="+e.password;return o.post(n,t).then(s,c)}function a(){var e="/api/v1/login_from_cookie";return o.post(e).then(s,c)}function s(e){r.debug("AuthService.login [SUCCESS] response",e);var o=t.create(e.data);return n.currentUser=o,n.$broadcast(i.loginSuccess,o),o}function c(e){return r.debug("AuthService.login [FAIL] response",e),n.$broadcast(i.loginFailed),null}function u(){t.destroy(),n.currentUser=void 0,n.$broadcast(i.logoutSuccess),o.jsonp("/account/logout")}function p(){return!!t.userId}function m(e){return angular.isArray(e)||(e=[e]),d.isAuthenticated()&&-1!==e.indexOf(t.userRole)}var d={login:l,loginFromCookie:a,logout:u,isAuthenticated:p,isAuthorized:m};return d}function o(e,o){var n={};return n.create=function(n){return e.currentUser=n.user,o.debug("User session created.",e.currentUser),e.currentUser},n.destroy=function(){delete e.currentUser,o.debug("User session destroyed.")},n.getCurrentUser=function(){return e.currentUser},n}e.$inject=["$q","$http","$rootScope","Session","$log","AUTH_EVENTS"],o.$inject=["$localStorage","$log"],angular.module("angular").factory("Session",o).factory("AuthService",e)}(),function(){"use strict";function e(e,o,n,t){var r=this;r.credentials={},r.login=function(){t.login(r.credentials)}}e.$inject=["noosfero","$log","$stateParams","AuthService"],angular.module("angular").controller("AuthController",e)}(),function(){"use strict";function e(e,o,n,t){function r(){i.profile=t.vm.owner,e.profiles.one(i.profile.id).one("activities").get().then(function(e){i.activities=e.activities})}var i=this;i.profile=null,i.activities=[],r()}e.$inject=["noosfero","$log","$stateParams","$scope"],angular.module("angular").controller("ProfileInfoController",e)}(),function(){"use strict";function e(e,o,n){function t(){e.profiles.one().get({identifier:n.profile}).then(function(o){return r.profile=o[0],e.boxes(r.profile.id).one().get()}).then(function(e){r.boxes=e.boxes})}var r=this;r.boxes=[],t()}e.$inject=["noosfero","$log","$stateParams"],angular.module("angular").controller("ProfileController",e)}(),function(){"use strict";function e(){}angular.module("angular").controller("MainController",e)}(),function(){"use strict";function e(e,o,n,t){function r(){i.profile=t.vm.owner,e.profiles.one(i.profile.id).one("articles").get({path:n.page}).then(function(e){i.article=e.article})}var i=this;i.article=null,i.profile=null,r()}e.$inject=["noosfero","$log","$stateParams","$scope"],angular.module("angular").controller("ContentViewerController",e)}(),function(){"use strict";function e(e,o,n){o.addFullRequestInterceptor(function(e,o,t,r,i){return n.getCurrentUser()&&(i["Private-Token"]=n.getCurrentUser().private_token),{headers:i}})}e.$inject=["$log","Restangular","Session"],angular.module("angular").run(e)}(),function(){"use strict";function e(e,o){o.when("/:profile","/profile/:profile"),e.state("main",{url:"/",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"vm",resolve:{currentUser:["AuthService",function(e){return e.loginFromCookie()}]}}).state("main.profile",{url:":profile",templateUrl:"app/profile/profile.html",controller:"ProfileController",controllerAs:"vm"}).state("main.profile.info",{url:"^/profile/:profile",templateUrl:"app/profile-info/profile-info.html",controller:"ProfileInfoController",controllerAs:"vm"}).state("main.profile.page",{url:"/{page:.*}",templateUrl:"app/content-viewer/page.html",controller:"ContentViewerController",controllerAs:"vm"}),o.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("angular").config(e)}(),function(){"use strict";angular.module("angular").constant("moment",moment).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success"})}(),function(){"use strict";function e(e,o,n,t){e.debugEnabled(!0),o.html5Mode({enabled:!0}),n.setBaseUrl("/api/v1"),t.defaults.headers.post={"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"}}e.$inject=["$logProvider","$locationProvider","RestangularProvider","$httpProvider"],angular.module("angular").config(e)}(),angular.module("angular").run(["$templateCache",function(e){e.put("app/content-viewer/page.html",'<noosfero-article ng-if="vm.article" article="vm.article" profile="vm.profile"></noosfero-article>'),e.put("app/main/main.html",'<acme-navbar></acme-navbar><div ui-view=""></div>'),e.put("app/profile/profile.html",'<div class="profile-container"><div class="row"><noosfero-boxes boxes="vm.boxes" owner="vm.profile"></noosfero-boxes></div></div>'),e.put("app/profile-info/profile-info.html",'<h3>{{vm.profile.name}}</h3><div class="profile-wall"><h4>Profile Wall</h4><noosfero-activities activities="vm.activities"></noosfero-activities></div>'),e.put("app/components/auth/login.html",'<div class="modal-header"><h3 class="modal-title">Login</h3></div><div class="modal-body"><form><div class="form-group"><label for="exampleInputEmail1">Login / Email address</label> <input type="text" class="form-control" id="exampleInputEmail1" placeholder="Login / Email" ng-model="vm.credentials.username"></div><div class="form-group"><label for="exampleInputPassword1">Password</label> <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password" ng-model="vm.credentials.password"></div><button type="submit" class="btn btn-default" ng-click="vm.login()">Login</button></form></div>'),e.put("app/components/boxes/boxes.html",'{{vm.boxesOrder}} {{boxesOrder}}<ng-include ng-repeat="box in vm.boxes | orderBy: vm.boxesOrder" src="\'app/components/noosfero-boxes/box.html\'"></ng-include>'),e.put("app/components/navbar/navbar.html",'<nav class="navbar navbar-static-top navbar-inverse"><div class="container-fluid"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" ng-click="isCollapsed = !isCollapsed"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" ng-href="/"><span class="noosfero-logo"><img src="/designs/themes/angular-theme/dist/assets/images/logo-noosfero.png"></span> Noosfero</a></div><div class="collapse navbar-collapse" id="navbar-collapse" collapse="isCollapsed"><ul class="nav navbar-nav"></ul><ul class="nav navbar-nav navbar-right"><li ng-show="!vm.currentUser"><a ng-href="#" ng-click="vm.openLogin()">Login</a></li><li class="dropdown profile-menu" ng-show="vm.currentUser" dropdown=""><a href="#" class="dropdown-toggle" aria-expanded="false" dropdown-toggle=""><i ng-if="!vm.currentUser.person.image" class="fa fa-user"></i> <img ng-if="vm.currentUser.person.image" ng-src="{{vm.currentUser.person.image.url}}" class="profile-image"> <span ng-bind="vm.currentUser.person.name"></span> <b class="caret"></b></a><ul class="dropdown-menu" dropdown-menu=""><li><a ng-href="/{{vm.currentUser.person.identifier}}"><i class="fa fa-fw fa-user"></i> Profile</a></li><li><a target="_self" ng-href="/myprofile/{{vm.currentUser.person.identifier}}"><i class="fa fa-fw fa-gear"></i> Settings</a></li><li class="divider"></li><li><a href="#" ng-click="vm.logout()"><i class="fa fa-fw fa-power-off"></i> Log Out</a></li></ul></li></ul></div></div></nav>'),e.put("app/components/noosfero-activities/activities.html",'<ul class="timeline"><li ng-class-even="\'timeline-inverted\'" ng-repeat="activity in activities | orderBy: \'created_at\':true"><noosfero-activity activity="activity"></noosfero-activity></li></ul>'),e.put("app/components/noosfero-boxes/box.html",'<div ng-class="{\'col-md-2-5\': box.position!=1, \'col-md-7\': box.position==1}"><div ng-repeat="block in box.blocks | orderBy: \'position\'" class="panel panel-default block"><div class="panel-heading" ng-show="block.title"><h3 class="panel-title">{{block.title}}</h3></div><div class="panel-body"><noosfero-block block="block" owner="vm.owner"></noosfero-block></div></div></div>'),e.put("app/components/noosfero-boxes/boxes.html",'<ng-include ng-repeat="box in vm.boxes | orderBy: vm.boxesOrder" src="\'app/components/noosfero-boxes/box.html\'"></ng-include>'),e.put("app/components/noosfero-activities/activity/activity.html",'<div class="activity"><ng-include src="vm.getActivityTemplate(vm.activity)"></ng-include></div>'),e.put("app/components/noosfero-activities/activity/add_member_in_community.html",'<div class="timeline-badge info"><i class="fa fa-user-plus"></i></div><div class="timeline-panel"><div class="timeline-heading"><h4 class="timeline-title"><strong ng-bind="vm.activity.user.name"></strong> has joined the community</h4><p><small class="text-muted"><i class="fa fa-clock-o"></i> <span am-time-ago="vm.activity.created_at"></span></small></p></div><div class="timeline-body"></div></div>'),e.put("app/components/noosfero-activities/activity/create_article.html",'<div class="timeline-badge success"><i class="fa fa-file-text"></i></div><div class="timeline-panel"><div class="timeline-heading"><h4 class="timeline-title"><strong ng-bind="vm.activity.user.name"></strong> has published on community <strong ng-bind="vm.activity.target.article.profile.name"></strong></h4><p><small class="text-muted"><i class="fa fa-clock-o"></i> <span am-time-ago="vm.activity.created_at"></span></small></p></div><div class="timeline-body"><div class="article"><div class="title"><a ng-href="/{{vm.activity.target.article.profile.identifier}}/{{vm.activity.target.article.path}}">{{vm.activity.target.article.title}}</a></div><div class="lead small"><div ng-bind-html="vm.activity.target.article.body | stripTags | truncate: 100 : \'...\'"></div></div></div></div></div>'),e.put("app/components/noosfero-articles/article/article.html",'<div class="page-header"><h3 ng-bind="vm.article.title"></h3></div><div><div ng-bind-html="vm.article.body"></div></div>'),e.put("app/components/noosfero-articles/blog/blog.html",'<div class="blog-cover" ng-show="vm.article.image"><img ng-src="{{vm.article.image.url}}" class="img-responsive"><h3 ng-bind="vm.article.title"></h3></div><div class="page-header" ng-show="!vm.article.image"><h3 ng-bind="vm.article.title"></h3></div><div><div ng-repeat="child in vm.article.children | orderBy: \'created_at\':true"><div class="page-header"><a ng-href="/{{vm.profile.identifier}}/{{child.path}}"><h4 ng-bind="child.title"></h4></a><div ng-bind-html="child.body | truncate: 500: \'...\'"></div></div></div></div>'),e.put("app/components/noosfero-blocks/link-list/link-list.html",'<div ng-repeat="link in vm.links"><a ng-href="{{link.address | noosferoTemplateFilter:{profile: vm.owner.identifier} }}"><i class="fa fa-fw icon-{{link.icon}}"></i> <span>{{link.name}}</span></a></div>'),e.put("app/components/noosfero-blocks/main-block/main-block.html",'<div ui-view=""></div>'),e.put("app/components/noosfero-blocks/profile-image/profile-image.html",'<div class="center-block text-center"><div class="profile-image"><a ng-href="/{{vm.owner.identifier}}"><img ng-show="{{vm.owner.image}}" src="{{vm.owner.image.url}}" class="img-responsive"> <i ng-show="{{!vm.owner.image}}" class="fa fa-users fa-5x"></i></a></div><div class="admin-link"><a target="_self" ng-href="/myprofile/{{vm.owner.identifier}}">Control panel</a></div></div>')}]);
//# sourceMappingURL=../maps/scripts/app-20413d4745.js.map
